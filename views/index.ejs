<% layout ('layout') %>
<div class="container">
	<h1>Apartment Management System</h1>
	<hr />

	<div class="margin-top-20">
		<a href="#" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#add-manager">Add Manager</a>
	</div>

  <% messages.forEach(function(message){ %>
  <div class="class alert alert-danger margin-top-20" role="alert">
    <% message.errors.forEach(function(error){ %>
    <div>
      <%= error.message %>
    </div>
    <% }); %>
  </div>
  <% }); %>

	<table class="table table-striped margin-top-20">
		<thead>
			<th>First Name</th>
			<th>Last Name</th>
			<th>Property Owned</th>
			<th>Action</th>
		</thead>
		<tbody>
      <% managers.forEach(function(m) { %>
			<tr>
        <td><%= m.firstname %></td>
        <td><%= m.lastname %></td>
        <td><%= m.property %></td>
				<td>
          <a href="/managers/<%= m.id %>/tenants" class="btn btn-primary">View Tenants</a>
				</td>
			</tr>

      <% if (m.Tenants) { %>
      <tr cols="5">
        <td>
          <h4>Tenants</h4>
          <table class="table table-striped margin-top-20">
            <thead>
              <th>Tenant name</th>
            </thead>
            <tbody>
              <% m.Tenants.forEach(function(t) { %>
              <tr><td><%= t.getFullName() %></td></tr>
              <% }); %>
            </tbody>
          </table>
        </td>
      </tr>
      <% } %>
      <% }); %>
		</tbody>
	</table>
</div>

<!-- Modal -->
<div class="modal fade" id="add-manager" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				<h4 class="modal-title" id="myModalLabel">Add a Manager</h4>
			</div>
      <form method="post" action="/managers">
        <div class="modal-body">
          <h4>First Name</h4>
          <div class="margin-top-20">
            <input name="firstname" 
              id="man-first-name" 
              class="form-control"
              placeholder="Manager First Name" />
          </div>
          <h4 class="margin-top-20">Last Name</h4>
          <div class="margin-top-20">
            <input 
              name="lastname"
              id="man-last-name" 
              class="form-control"
              placeholder="Manager Last Name" />
          </div>
          <h4 class="margin-top-20">Property Owned</h4>
          <div class="margin-top-20">
            <input 
              name="property"
              id="prop-address" 
              class="form-control"
              placeholder="Property Address" />
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button id="save-manager" type="submit" class="btn btn-primary">Save Manager</button>
        </div>
      </form>
		</div>
	</div>
</div>
<!--/Modal-->
